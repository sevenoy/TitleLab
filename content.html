<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>文案管理 - Title & Copy Management</title>

  <!-- 样式 -->
  <link rel="stylesheet" href="assets/style.css" />

  <!-- icon -->
  <link rel="icon" sizes="192x192" href="icon/icon-192.png" />
  <link rel="icon" sizes="512x512" href="icon/icon-512.png" />
</head>
<body class="bg-page">
  <div class="wrap">
    <!-- 顶部栏 -->
    <header class="topbar">
      <div class="topbar-left">
        <div class="logo-mark">
          <span class="logo-main">C</span>
        </div>
        <h1 class="topbar-title">标题与文案管理系统</h1>
      </div>

      <div class="topbar-right">
        <button id="btnTitlePage" type="button" class="function-btn ghost">
          标题
        </button>
        <button id="btnCopyPage" type="button" class="function-btn primary">
          文案
        </button>
        <button id="btnSettings" type="button" class="function-btn ghost">
          显示设置
        </button>
        <button id="btnManagePage" type="button" class="function-btn ghost">
          管理中心
        </button>
      </div>
    </header>

    <!-- 主体布局：左侧分类 + 右侧列表 -->
    <main class="layout">
      <!-- 左侧分类栏 -->
      <aside class="panel" style="width:260px;flex-shrink:0;">
        <!-- 手机端分类下拉 -->
        <div id="mobileCategoryWrapper" class="md:hidden mb-3" data-open="0">
          <button
            id="mobileCategoryToggle"
            class="function-btn ghost w-full justify-between"
          >
            <span id="mobileCategoryLabel">全部</span>
            <span>▼</span>
          </button>
        </div>

        <div class="sidebar-header">
          <div class="sidebar-title">文案分类</div>
          <div class="sidebar-actions">
            <button id="btnAddCategory" class="function-btn ghost text-xs">
              新增
            </button>
            <button id="btnDeleteCategory" class="function-btn ghost text-xs">
              删除
            </button>
            <button id="btnSortCategory" class="function-btn ghost text-xs">
              排序
            </button>
          </div>
        </div>

        <ul id="categoryList" class="category-list"></ul>

        <div class="sidebar-section">
          <div class="sidebar-title mt-4 mb-2">云端快照（文案）</div>
          <div class="flex gap-2">
            <button id="btnSaveCloud" class="function-btn ghost text-xs">
              保存云端
            </button>
            <button id="btnLoadCloud" class="function-btn ghost text-xs">
              加载云端
            </button>
          </div>
        </div>
      </aside>

      <!-- 右侧内容 -->
      <section class="panel" style="flex:1;min-width:0;">
        <!-- 工具栏 -->
        <div class="toolbar" style="margin-bottom:12px;">
          <div class="toolbar-row">
            <div class="toolbar-left">
              <div class="search-wrapper">
                <input
                  id="searchInput"
                  type="text"
                  class="field-input search-input"
                  placeholder="搜索文案内容…"
                />
                <button
                  id="btnClearSearch"
                  class="function-btn ghost text-xs search-clear-btn"
                  style="display:none;"
                >
                  清除
                </button>
              </div>

              <select id="filterScene" class="field-input filter-select">
                <option value="">场景（全部）</option>
              </select>
            </div>

            <div class="toolbar-right">
              <button id="btnNewCopy" class="function-btn">
                新增文案
              </button>
              <button
                id="btnBatchImport"
                class="function-btn ghost text-xs"
              >
                批量导入
              </button>
              <button id="btnClearAll" class="function-btn ghost text-xs">
                清空全部
              </button>
            </div>
          </div>
        </div>

        <!-- 桌面表格 -->
        <div class="panel" style="margin-bottom:10px;">
          <table class="basic-table w-full">
            <thead>
              <tr>
                <th class="w-12">#</th>
                <th class="text-left">文案内容</th>
                <th class="w-28 text-left">主分类</th>
                <th class="w-40 text-center">操作</th>
              </tr>
            </thead>
            <tbody id="copyTableBody"></tbody>
          </table>
        </div>

        <!-- 手机端卡片列表 -->
        <div id="mobileList" class="flex flex-col gap-2 md:hidden"></div>
      </section>
    </main>

    <!-- 文案弹窗 -->
    <div id="copyModal" class="modal-backdrop hidden">
      <div class="modal panel">
        <div class="modal-header">
          <div class="modal-title" id="copyModalTitle">新增文案</div>
          <button id="btnCloseModal" class="modal-close">×</button>
        </div>

        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">文案内容</label>
            <textarea
              id="fieldText"
              class="textarea field-input"
              rows="4"
              placeholder="输入文案内容…"
            ></textarea>
          </div>

          <div class="form-row">
            <div class="form-group flex-1">
              <label class="form-label">主分类</label>
              <select id="fieldMainCategory" class="select field-input"></select>
            </div>
            <div class="form-group flex-1">
              <label class="form-label">文案类型</label>
              <input
                id="fieldContentType"
                class="input field-input"
                placeholder="如：开头 / 结尾 / 引导语…"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">场景标签</label>
            <input
              id="fieldSceneTags"
              class="input field-input"
              placeholder="如：城堡，夜景，咖啡馆…"
            />
          </div>
        </div>

        <div class="modal-footer">
          <button id="btnCancelModal" class="function-btn ghost">取消</button>
          <button id="btnSaveCopy" class="function-btn">
            保存文案
          </button>
        </div>
      </div>
    </div>

    <!-- 批量导入 -->
    <div id="importModal" class="modal-backdrop hidden">
      <div class="modal panel">
        <div class="modal-header">
          <div class="modal-title">批量导入文案</div>
          <button id="btnCloseImport" class="modal-close">×</button>
        </div>

        <div class="modal-body">
          <textarea
            id="importRawInput"
            class="textarea field-input"
            rows="8"
            placeholder="每一行一条文案内容…"
          ></textarea>
        </div>

        <div class="modal-footer">
          <button id="btnCancelImport" class="function-btn ghost">取消</button>
          <button id="btnRunImport" class="function-btn">
            开始导入
          </button>
        </div>
      </div>
    </div>

    <!-- 云端快照浮层 -->
    <div id="cloudHistoryPanel" class="cloud-history-panel hidden"></div>

    <!-- Toast -->
    <div id="toast" class="toast hidden"></div>
  </div>

  <!-- Supabase -->
  <script src="assets/supabase-client.js"></script>

  <!-- 文案功能核心 -->
  <script src="assets/app-copy.js"></script>

  <!-- 顶部导航绑定（文案按钮改为跳 content.html 本页） -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("btnTitlePage").onclick = () =>
        (location.href = "index.html");
      document.getElementById("btnCopyPage").onclick = () =>
        (location.href = "content.html");
      document.getElementById("btnSettings").onclick = () =>
        (location.href = "settings.html");
      document.getElementById("btnManagePage").onclick = () =>
        (location.href = "admin-center.html");
    });
  </script>
</body>
</html>
