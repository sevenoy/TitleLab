<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>管理中心 - 标题与文案库</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="管理中心" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="stylesheet" href="assets/styles.css" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon/icon-192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon/icon-512.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="icon/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="icon/icon-512.png" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="assets/supabase.js"></script>
    <script src="assets/admin.js"></script>
    <script src="assets/pwa.js"></script>
  </head>
  <body class="bg-page">
    <div class="wrap">
      <header class="topbar">
        <div class="topbar-left">
          <div class="logo-dot"></div>
          <div class="ml-2">
            <div class="topbar-title">管理中心</div>
          </div>
        </div>
        <div class="topbar-center">
          <button class="nav-tab" onclick="window.location.href='title.html'">标题</button>
          <button class="nav-tab" onclick="window.location.href='content.html'">文案</button>
        </div>
        <div class="topbar-right">
          <span id="currentUserName" class="user-badge text-xs"></span>
          <button id="btnLogout" class="function-btn ghost text-xs btn-compact">退出</button>
          <button id="btnLoginHeader" class="function-btn ghost text-xs hidden">登陆</button>
        </div>
      </header>

      <div class="mt-2">
        <button class="nav-tab nav-tab-active" onclick="window.location.href='title.html'">返回主页</button>
      </div>


      <main class="layout flex-col gap-3">
        <section class="panel">
          <div class="flex items-center justify-between">
            <h2 class="panel-title">数据概览</h2>
            <div class="text-xs text-gray-500">统一快照与数据运维</div>
          </div>
          <div class="grid gap-3 grid-cols-2">
            <div class="panel">
              <div class="text-sm text-gray-500">标题条数</div>
              <div id="overviewTitleCount" class="text-2xl font-semibold">—</div>
            </div>
            <div class="panel">
              <div class="text-sm text-gray-500">文案条数</div>
              <div id="overviewContentCount" class="text-2xl font-semibold">—</div>
            </div>
          </div>
          <div class="panel mt-3">
            <div class="text-sm text-gray-500">最新快照</div>
            <div id="overviewLatestSnapshot" class="text-xs">—</div>
          </div>
        </section>

        <section class="panel">
          <div class="flex items-center justify-between">
            <h2 class="panel-title">云端快照</h2>
            <div class="flex gap-2 flex-wrap items-center">
              <button id="btnSaveUnifiedSnapshot" class="function-btn ghost">保存统一快照</button>
              <button id="btnToggleSnapshots" class="function-btn ghost">查看快照</button>
              <input id="snapshotSearchInput" class="field-input" placeholder="搜索快照" />
              <button id="snapshotPrev" class="function-btn ghost text-xs">上一页</button>
              <button id="snapshotNext" class="function-btn ghost text-xs">下一页</button>
            </div>
          </div>
          <div id="snapshotList" class="space-y-2 mt-2"></div>
        </section>

        <section class="panel">
          <div class="flex items-center justify-between">
            <h2 class="panel-title">数据运维</h2>
            <div class="text-xs text-gray-500">导出、去重、归一化</div>
          </div>
          <div class="grid gap-3 md:grid-cols-2">
            <div class="panel">
              <div class="flex gap-2 flex-wrap">
                <button id="btnExportTitlesCsv" class="function-btn ghost">导出标题 CSV</button>
                <button id="btnExportContentsCsv" class="function-btn ghost">导出文案 CSV</button>
                <button id="btnExportTitlesJson" class="function-btn ghost text-xs">导出标题 JSON</button>
                <button id="btnExportContentsJson" class="function-btn ghost text-xs">导出文案 JSON</button>
              </div>
            </div>
            <div class="panel">
              <div class="flex gap-2 flex-wrap">
                <button id="btnDedupTitles" class="function-btn ghost">标题去重</button>
                <button id="btnDedupContents" class="function-btn ghost">文案去重</button>
                <button id="btnNormalizeTitles" class="function-btn ghost">标题归一化空白</button>
                <button id="btnNormalizeContents" class="function-btn ghost">文案归一化空白</button>
              </div>
              <div id="adminProgress" class="text-xs text-gray-500 mt-2"></div>
              <div id="dedupPreview" style="display: none; margin-top: 16px; padding: 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; max-height: 500px; overflow-y: auto;"></div>
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="flex items-center justify-between">
            <h2 class="panel-title">分类管理</h2>
          </div>
          <div class="flex gap-2 flex-wrap">
            <button id="btnCopyTitleCatsToContent" class="function-btn ghost">标题分类复制到文案</button>
            <button id="btnCopyContentCatsToTitle" class="function-btn ghost">文案分类复制到标题</button>
            <button id="btnResetCatsDefault" class="function-btn ghost">重置默认分类</button>
          </div>
        </section>

        <section class="panel">
          <div class="flex items-center justify-between">
            <h2 class="panel-title">危险操作</h2>
          </div>
          <div class="flex gap-2 flex-wrap">
            <button id="btnClearTitlesAdmin" class="function-btn ghost">清空标题表</button>
            <button id="btnClearContentsAdmin" class="function-btn ghost">清空文案表</button>
          </div>
        </section>
      </main>
      <div id="toast" class="toast hidden"></div>
      <div id="dangerConfirmBackdrop" class="modal-backdrop hidden"></div>
      <div id="dangerConfirmModal" class="modal hidden">
        <div class="modal-header">
          <div class="modal-title">确认危险操作</div>
          <button id="dangerConfirmClose" class="icon-btn">×</button>
        </div>
        <div class="modal-body">
          <div id="dangerConfirmText" class="text-sm text-gray-700"></div>
          <input id="dangerConfirmInput" class="field-input mt-2" placeholder="输入：清空" />
        </div>
        <div class="modal-footer">
          <button id="dangerConfirmCancel" class="function-btn ghost">取消</button>
          <button id="dangerConfirmOk" class="function-btn">确认执行</button>
        </div>
      </div>
    </div>
  </body>
</html>
