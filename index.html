<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
  />
  <title>标题管理 - Title & Copy Management</title>

  <!-- 样式：路径按你项目调整 -->
  <link rel="stylesheet" href="assets/styles.css" />

  <!-- icon 文件夹：你根目录下的 icon-192 / icon-512 -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="icon/icon-512.png" />
</head>
<body>
  <div class="app-shell">
    <!-- 顶部栏 -->
    <header class="topbar">
      <div class="topbar-left">
        <div class="logo-mark">
          <!-- 这里可以放你的品牌简写，现在先简单用 T -->
          <span class="logo-main">T</span>
        </div>
        <h1 class="topbar-title">标题与文案管理系统</h1>
      </div>

      <div class="topbar-actions">
        <!-- 顶部导航：标题 / 文案 / 设置 / 管理中心 -->
        <button
          id="btnTitlePage"
          type="button"
          class="function-btn primary"
        >
          标题
        </button>
        <button
          id="btnCopyPage"
          type="button"
          class="function-btn ghost"
        >
          文案
        </button>
        <button
          id="btnSettings"
          type="button"
          class="function-btn ghost"
        >
          显示设置
        </button>
        <button
          id="btnManagePage"
          type="button"
          class="function-btn ghost"
        >
          管理中心
        </button>
      </div>
    </header>

    <main class="main-layout">
      <!-- 左侧：分类 + 云端快照 -->
      <aside class="sidebar panel">
        <!-- 手机端分类切换 -->
        <div
          id="mobileCategoryWrapper"
          class="md:hidden mb-3"
          data-open="0"
        >
          <button
            id="mobileCategoryToggle"
            type="button"
            class="function-btn ghost w-full justify-between"
          >
            <span id="mobileCategoryLabel">全部</span>
            <span>▼</span>
          </button>
        </div>

        <div class="sidebar-header">
          <div class="sidebar-title">标题分类</div>
          <div class="sidebar-actions">
            <button
              id="btnAddCategory"
              type="button"
              class="function-btn ghost text-xs"
            >
              新增
            </button>
            <button
              id="btnDeleteCategory"
              type="button"
              class="function-btn ghost text-xs"
            >
              删除
            </button>
            <button
              id="btnSortCategory"
              type="button"
              class="function-btn ghost text-xs"
            >
              排序
            </button>
          </div>
        </div>

        <ul id="categoryList" class="category-list"></ul>

        <div class="sidebar-section">
          <div class="sidebar-title mt-4 mb-2">云端快照（标题）</div>
          <div class="flex gap-2 flex-wrap">
            <button
              id="btnSaveCloud"
              type="button"
              class="function-btn ghost text-xs"
            >
              保存云端
            </button>
            <button
              id="btnLoadCloud"
              type="button"
              class="function-btn ghost text-xs"
            >
              加载云端
            </button>
          </div>
        </div>
      </aside>

      <!-- 右侧：标题列表 -->
      <section class="content">
        <!-- 工具栏：搜索 / 场景 / 按钮 -->
        <div class="toolbar panel">
          <div class="toolbar-row">
            <div class="toolbar-left">
              <div class="flex items-center gap-2">
                <input
                  id="searchInput"
                  type="text"
                  class="input"
                  placeholder="搜索标题内容…"
                />
                <button
                  id="btnClearSearch"
                  type="button"
                  class="function-btn ghost text-xs"
                  style="display:none;"
                >
                  清除
                </button>
              </div>

              <select id="filterScene" class="select ml-2">
                <option value="">场景（全部）</option>
                <!-- 选项由 JS 根据显示设置填充 -->
              </select>
            </div>

            <div class="toolbar-right">
              <button
                id="btnNewTitle"
                type="button"
                class="function-btn primary text-xs"
              >
                新增标题
              </button>
              <button
                id="btnBatchImport"
                type="button"
                class="function-btn ghost text-xs"
              >
                批量导入
              </button>
              <button
                id="btnClearAll"
                type="button"
                class="function-btn ghost text-xs"
              >
                清空全部
              </button>
            </div>
          </div>
        </div>

        <!-- 桌面表格：仅在 md 及以上设备显示 -->
        <div class="panel hidden md:block">
          <table class="basic-table w-full">
            <thead>
              <tr>
                <th class="w-12">#</th>
                <th class="text-left">标题</th>
                <th class="w-28 text-left">主分类</th>
                <th class="w-40 text-center">操作</th>
              </tr>
            </thead>
            <tbody id="titleTableBody"></tbody>
          </table>
        </div>

        <!-- 移动端卡片列表 -->
        <div
          class="md:hidden flex flex-col gap-2"
          id="mobileList"
        ></div>
      </section>
    </main>

    <!-- 标题编辑弹窗 -->
    <div
      id="titleModal"
      class="modal-backdrop hidden"
    >
      <div class="modal panel">
        <div class="modal-header">
          <div
            id="titleModalTitle"
            class="modal-title"
          >
            新增标题
          </div>
          <button
            id="btnCloseModal"
            type="button"
            class="modal-close"
          >
            ×
          </button>
        </div>

        <div class="modal-body">
          <div class="form-group">
            <label for="fieldText" class="form-label">标题内容</label>
            <textarea
              id="fieldText"
              class="textarea"
              rows="3"
              placeholder="输入标题内容…"
            ></textarea>
          </div>

          <div class="form-row">
            <div class="form-group flex-1">
              <label for="fieldMainCategory" class="form-label">
                主分类
              </label>
              <select
                id="fieldMainCategory"
                class="select w-full"
              >
                <!-- 由 JS 根据分类列表填充 -->
              </select>
            </div>

            <div class="form-group flex-1">
              <label for="fieldContentType" class="form-label">
                标题类型
              </label>
              <input
                id="fieldContentType"
                type="text"
                class="input w-full"
                placeholder="例如：笔记标题 / 短视频标题…"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="fieldSceneTags" class="form-label">
              场景标签（多个用逗号或顿号分隔）
            </label>
            <input
              id="fieldSceneTags"
              type="text"
              class="input"
              placeholder="例如：港迪城堡，夜景，烟花…"
            />
          </div>
        </div>

        <div class="modal-footer">
          <button
            id="btnCancelModal"
            type="button"
            class="function-btn ghost"
          >
            取消
          </button>
          <button
            id="btnSaveTitle"
            type="button"
            class="function-btn primary"
          >
            保存标题
          </button>
        </div>
      </div>
    </div>

    <!-- 批量导入弹窗 -->
    <div
      id="importModal"
      class="modal-backdrop hidden"
    >
      <div class="modal panel">
        <div class="modal-header">
          <div class="modal-title">批量导入标题</div>
          <button
            id="btnCloseImport"
            type="button"
            class="modal-close"
          >
            ×
          </button>
        </div>

        <div class="modal-body">
          <div class="form-group">
            <label for="importRawInput" class="form-label">
              一行一条标题
            </label>
            <textarea
              id="importRawInput"
              class="textarea"
              rows="8"
              placeholder="每一行是一条标题内容…"
            ></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button
            id="btnCancelImport"
            type="button"
            class="function-btn ghost"
          >
            取消
          </button>
          <button
            id="btnRunImport"
            type="button"
            class="function-btn primary"
          >
            开始导入
          </button>
        </div>
      </div>
    </div>

    <!-- 标题云端快照历史弹层 -->
    <div
      id="cloudHistoryPanel"
      class="cloud-history-panel hidden"
    >
      <!-- 内容由 JS 渲染 -->
    </div>

    <!-- 全局 Toast（标题 / 文案 / 设置 共用） -->
    <div
      id="toast"
      class="toast hidden"
    ></div>
  </div>

  <!-- Supabase 初始化：这里改成和你原来 index.html 一样的脚本 -->
  <script src="assets/supabase-client.js"></script>

  <!-- 标题主逻辑 -->
  <script src="assets/app-title.js"></script>

  <!-- 顶部导航按钮里“文案”跳转 copy.html，其它按钮在 app-title.js 里绑定 -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const btnCopyPage = document.getElementById('btnCopyPage');
      if (btnCopyPage) {
        btnCopyPage.addEventListener('click', function () {
          window.location.href = 'copy.html';
        });
      }
    });
  </script>
</body>
</html>
